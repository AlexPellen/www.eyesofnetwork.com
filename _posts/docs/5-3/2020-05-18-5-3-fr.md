---
title: "5.3"
categories: docs
lang: fr
layout: docs
ref: 5-3
permalink: /fr/docs/5_3
---

# Documentation d'EyesOfNetwork 5.3

**⚠ Documentation en cours de rédaction ⚠**

EyesOfNetwork (“EON”) est la solution Open Source réunissant de manière pragmatique les processus ITIL et l’interface technologique permettant leur application. EyesOfNetwork Supervision est la première brique d’une gamme de produits bâtie autour de la gestion des évènements, de la disponibilité, des problèmes et de la capacité.

Le “bundle” EyesOfNetwork est composé d’un système d’exploitation minimaliste incluant un ensemble intégré d’applications répondant aux différents besoins de supervision :

* GED (Generic Event Dispatcher) : gestion multi sites et sécurisée des évènements,
* NAGIOS : gestion des incidents et des problèmes,
* THRUK : interface de supervision multibackend,
* NAGVIS : cartographie personnalisée de la disponibilité,
* THUKBP : gestion de la criticité des applications,
* GRAFANA & INFLUXDB : gestion des performances,
* BACKUP MANAGER : Outil de sauvegarde de la solution,
* EONWEB : Interface Web unifiée de la solution,
* SNMPTT : Traduction des traps snmp,
* GLPI / OCS / FUSION : Gestion de parc et inventaire.

EyesOfNetwork est accessible via une interface Web unique dont l’objectif est de réunir les différents acteurs d’un système d’informations (DSI, Administrateurs, Techniciens, Opérateurs, …). Chacun des ces acteurs dispose d’une vue correspondant à son métier. Toutes les informations sont consolidées en Base de Données.

EyesOfNetwork est un produit sous licence GPL2 sponsorisé et proposé par AXIANS dans le cadre de prestations de services (Intégration, Télé-service, Support téléphonique et Tierce Maintenance Applicative).

Site internet : [https://www.eyesofnetwork.com/](https://www.eyesofnetwork.com/)

## Installation

EyesOfNetwork est livré sous forme d'une *appliance* prete à l'emploi. En version 5.3, deux modes d'installation sont officiellement supporté.

### Installation par image ISO

Le mode d'installation par image ISO 

### Installation par Ansible

## Administration

Il est possible que vous ayez à redémarrer des processus comme nagios, httpd et autres. Pour cela l&#39;interface EON offre dans le menu : Administration ==> Généralités ==> Processus, une interface permettant de verifier le bon fonctionnement des processus et d&#39;effectuer les actions les plus courante d&#39;un administrateur :

 ![Erreur1](/img/docs/5-3/2020-08-25-process.PNG)


Les boutons permettent d&#39;effectuer les actions en lignes de commandes suivantes :

_ **systemctl stop/start/restart/reload** _

Le premier bouton **« Stopper »** par exemple **,** nous montre que le service tourne et permet de l&#39;arrêter en appuyant dessus.



/!\ Le bouton « Vérifier » est spécifique à nagios et permet de vérifier différente information sur nagios via la fenêtre de log qui s&#39;affiche en bas de la page après avoir effectué une action.(Voir figure ci-dessous)
![Erreur1](/img/docs/5-3/2020-08-25-process_log.PNG)

### Création d'un équipement

Un Hôte représente un équipement (un serveur, un switch, un onduleur, …) sur une infrastructure.

![Accueil](/img/docs/5-3/2020-08-25-accueil_eon.PNG)

![addHostBtn](/img/docs/5-3/2020-08-25-add_host_btn.PNG)
![addHost](/img/docs/5-3/2020-08-25-add_host.PNG)

### Création d'un service

### Création d'une commande Nagios

Une commande permet d&#39;effectuer des tests sur les équipements. Les commandes exécutent des scripts créés spécifiquement pour Nagios. (Exemple de _ **script check\_snmp\_process.pl** _) Ces scripts demandent un ensemble d&#39;arguments afin d&#39;interroger un équipement par snmp **(/!\ vérifier que le snmp est bien actif sur vos machines**). Des variables sont prédéfinies afin de simplifier leurs écritures comme :

- **$HOSTADDRESS$** : permettant de récupérer l&#39;adresse IP de l&#39;hôte
- **$USERi$** : (_ou i est un entier)_ sont des Variables que vous pouvez définir dans le menu « **Nagios Resources** » de « **Eonweb Configurator** »
- **$ARGi$** : (_ou i est un entier)_ sont des variables que vous définissez lors de la création du service.

![Erreur1](/img/docs/5-3/2020-08-25-commande_btn.PNG)
![Erreur1](/img/docs/5-3/2020-08-25-create_cmd.PNG)

Pour tester ces scripts, vous pouvez aller dans «_ **/srv/eyesofnetwork/nagios/plugins** _ » et executer la commande avec l&#39;option « –help » pour voir les options nécéssaires. Un ensemble de check sont également disponible sur le net. Vous avez juste à les placer dans ce même dossier et à modifier ses droits (Exemple : _ **chown nagios:eyesofnetwork script\_name.pl** _).

### Création d'un modèle d'équipement

Un « Host Template » permet de définir des paramètres pour un type d&#39;équipements. L&#39;une des bonnes pratiques, est de définir le maximum d&#39;éléments dans ces Template (L&#39;appartenance à un groupe, la définition des services, … ).

![TemplateBtn](/img/docs/5-3/2020-08-25-template_btn.PNG)

![HostTemplate](/img/docs/5-3/2020-08-25-host_template.PNG)

Dans le menu « **Inheritance** », du Host template une fois créé, vous devrez toujours ajouter le template **GENERIC\_HOST au minimum**. Vous devriez obtenir un résultat similaire à la capture ci-dessous.

![Erreur1](/img/docs/5-3/2020-08-25-host_template_conf.PNG)

Dans le menu « Services », Vous pourrez ajouter des services permettant d&#39;effectuer des tests sur les équipements qui hériteront de ce template. En cliquant sur le bouton ci-dessous, vous allez créer un service pour ce template.

![Erreur1](/img/docs/5-3/2020-08-25-host_template_service.PNG) 

![Erreur1](/img/docs/5-3/2020-08-25-create_service.PNG)

### Création d'un modèle de service

### Restauration d'une sauvegarde de base de données

### Installation d'une ressource RPM Tiers

### Enregistrer la configuration

Appliquer la configuration est nécessaire afin que Nagios prenne en compte les modifications effectuées. En haut à droite lorsque vous êtes dans le menu "Configurations nagios", vous avez une barre de menu qui apparait avec l’onglet outils qui vous permet d’appliquer la configuration. 
![Erreur1](/img/docs/5-3/2020-08-25-apply_config_menu.PNG)
![Erreur1](/img/docs/5-3/2020-08-25-apply_config.PNG)

Vous devriez avoir un résultat similaire à la capture d&#39;écran ci-dessous si tout s&#39;est bien passé.

![Erreur1](/img/docs/5-3/2020-08-25-apply_config_result.PNG)

Sinon, cela signifie que l&#39;un des ajouts ou modifications effectué n&#39;est pas correctement paramétré. (Cela est souvent dû à l&#39;oubli de l&#39;application d&#39;un Template à l&#39;un de vos équipements). Pour avoir plus d&#39;informations, vous avez la console de log en bas de la page, en appuyant sur le bouton « recharger » :

![Erreur1](/img/docs/5-3/2020-08-25-reload.PNG) Vous devriez voir apparaître des éléments supplémentaires dans la console des logs afin de voir où l&#39;application de la configuration a échouée.

### Notification Avancé

Pour utiliser les notifications avancées, cliquez sur « Administration » dans le latéral d&#39;EON puis sur le sous-menu latéral sur « Notifications avancées »

##### Périodes de notification : Ajout / Modification

Ajout :

![Erreur1](/img/docs/5-3/2020-08-25-add_notif.PNG)

Vous pouvez cliquer sur le bouton période du menu supérieur puis le sous menu « lister ». Vous arriverez sur la page ci-dessus. Si vous voulez ajouter une règle, cliquez sur le bouton ajouter (la page ci-dessous s&#39;affichera).

![Erreur1](/img/docs/5-3/2020-08-25-add_period.PNG)

Afin d&#39;ajouter une période de notification, cliquez sur le bouton [période] du menu supérieur de la page. Ensuite pour ajouter une période de notification, il faut cliquer sur le sous menu « ajouter ». Une fois ces actions effectuées, vous allez être redirigés vers un formulaire d&#39;ajout de période de notification que l&#39;on peut voir sur l&#39;image ci-dessus.

Modification :

Si vous voulez modifier une période de notification, cliquez sur son nom (Comme sur l&#39;image ci-dessous).

![Erreur1](/img/docs/5-3/2020-08-25-modif_period.PNG)
Vous allez donc arriver sur la page ci-dessous.

![Erreur1](/img/docs/5-3/2020-08-25-modif_period_int.PNG)


Dans ce formulaire, l&#39;unique champ obligatoire est le nom de la période de notification (1). Le Second champ (2) permet de définir les jours de notification de votre période. Le lien « All / None » permet de tout sélectionner ou désélectionner rapidement. Enfin le dernier champ Heure de notification permet de définir les heures de début et de fin des périodes de notification (3). Pour ajouter des périodes, sélectionnés à l&#39;aide des différents menus déroulants surlignés en jaune le début et la fin de la période. Une fois ceci réalisé, cliquez sur le bouton « Add » pour l&#39;ajouter à la liste située à gauche du bouton « Delete ». Le delete, lui permet de supprimer la période sélectionnée. On peut remarquer un bouton « All » à droite des listes déroulantes. Ce bouton permet de définir la période en 24/24. Une petite étoile s&#39;ajoutera alors à la liste. Avant de cliquer sur « Add », assurez-vous que la ou les périodes sont toutes sélectionnées comme sur l&#39;image ci-dessus. Dans le cas où aucune heure de notification est ajouté, la valeur ajouté sera «-».

Si on se fie à l&#39;exemple ci-dessus, notre période de notification HO fonctionnera tous les jours de la semaine 24h/24.

##### Périodes de notification : Supression

![Erreur1](/img/docs/5-3/2020-08-25-delete_period.PNG)

1. Dans un premier temps, il vous suffit de cocher les différentes périodes de notification que vous souhaitez supprimer
2. Ensuite, cliquez sur le bouton « Supprimer »

Si tout s&#39;est bien passé, un message s&#39;affichera pour vous confirmer la suppression du ou des éléments.

##### Méthodes de notification : Ajout / Modification

Ajout :

![Erreur1](/img/docs/5-3/2020-08-25-method_global.PNG)

Vous pouvez cliquer sur le bouton période du menu supérieur puis les sous menus « lister ». Vous arriverez sur la page ci-dessus. Si vous voulez ajouter une règle, cliquez sur le bouton ajouter (la page ci-dessous s&#39;affichera).

![Erreur1](/img/docs/5-3/2020-08-25-add_method.PNG)

Afin d&#39;ajouter une méthode de notification, cliquez sur le bouton « Méthodes » du menu supérieur de la page. Ensuite pour ajouter une méthode de notification, il faut sélectionner « ajouter une méthode d&#39;équipement » ou « ajouter une méthode de service » dans le sous menu. Une fois ces actions effectuées, vous allez être redirigés vers un formulaire d&#39;ajout de méthode que l&#39;on peut voir sur l&#39;image ci-dessus.

Modification :

Si vous voulez modifier une méthode de notification, cliquez sur son nom (Comme sur l&#39;image ci-dessous).

![Erreur1](/img/docs/5-3/2020-08-25-modify_method_btn.PNG)

Vous allez donc arriver sur la page ci-dessous.

![Erreur1](/img/docs/5-3/2020-08-25-modify_method.PNG)

Dans ce formulaire, les champs obligatoires sont la Nom de la méthode (1) et la ligne de commande (3). Le Second champ (2) est défini automatiquement en fonction du type de la method (service ou host). Enfin le dernier champ ligne de commande (3).

##### Méthodes de notification : Supression

![Erreur1](/img/docs/5-3/2020-08-25-delete_method.PNG)

1. Dans un premier temps, il vous suffit de cocher les différentes méthodes de notification que vous souhaitez supprimer
2. Ensuite, sélectionner l&#39;option « Supprimer »
3. Si tout s&#39;est bien passé, un message s&#39;affichera pour vous confirmer la suppression du ou des éléments.

##### Règles de notification : Ordre des notifications

![Erreur1](/img/docs/5-3/2020-08-25-notif_order.PNG)

Lors du chargement de la page d&#39;index, vous arriverez sur la page ci-dessus. Vous pouvez cliquer sur le bouton « Règle » du menu supérieur puis le sous menu « lister ». Vous arriverez sur la page ci-dessus. Si vous voulez ajouter une règle, cliquez sur le bouton ajouter (la page ci-dessous s&#39;affichera).

La règle la plus en haut du tableau est la règle prioritaire (de niveau 0). Pour changer l&#39;ordre de priorité, il vous suffit de cliquer sur les boutons up et down. Exemple pour passer la règle « Rule Hosts 40 » en prioritaire, il vous suffit de cliquer sur le bouton surligné. Un clic sur le lien down de « Rule Host 38 » aurait eu le même impact étant donné l&#39;ordre.

##### Règles de notification : Ajout / Modification

![Erreur1](/img/docs/5-3/2020-08-25-rule.PNG)

Ajout :

Vous pouvez cliquer sur le bouton « Règle » du menu supérieur puis le sous menu « lister ». Vous arriverez sur la page ci-dessus. Si vous voulez ajouter une règle, cliquez sur le bouton ajouter, la page ci-dessous s&#39;affichera (dans la partie modification).

Afin d&#39;ajouter une règle, cliquez sur le bouton « Règle » du menu supérieur de la page. Ensuite pour ajouter une règle, il faut sélectionner « ajouter une règle d&#39;équipement » ou « ajouter une règle de service » dans le sous menu. Une fois ces actions effectuées, vous allez être redirigés vers un formulaire d&#39;ajout de règle que l&#39;on peut voir sur l&#39;image ci-dessous (dans la partie modification).

Modification :

Si vous voulez modifier une règle de notification, cliquez sur son nom.

 ![Erreur1](/img/docs/5-3/2020-08-25-add_rule.PNG)

Les champs Nom, période de notification et méthodes de notification sont obligatoires dans ce formulaire. Tout champs non obligatoire n&#39;étant pas rempli prendra la valeur «-».

- **1:** Dans cette case vous allez nommer votre règle
- **2:** est défini automatiquement en fonction du type de règle choisi sur la page index (host ou service)
- **3:** permet de définir le niveau de debug de la règle
- **4:** ajout de contact, des contacts ou des groupes de contacts provenant de la base lilac vous seront proposés lors de la saisie. Il est malgré tout possible d&#39;ajouter une valeur n&#39;existant pas dans la base.
- **5 :** ajout d&#39;hosts, des hosts ou des groupes de host provenant de la base lilac vous seront proposés lors de la saisie. Il est malgré tout possible d&#39;ajouter une valeur n&#39;existant pas dans la base.
- **6 :** Sélection des différents états de la règle
- **7 ** : Ajoutez le nombre de notifications avant émission de la notification
- **8 :** ajout d&#39;une période de notification, des notifperiod déjà créé vous seront proposés lors de la saisie
- **9 :** Ajout d&#39;une ou plusieurs méthodes, à partir de celle proposé lors de la saisie
**Auto-completes multiples (étapes 4,5,9) :** remplissez à l&#39;aide de l&#39;auto-complete la valeur souhaitée, puis cliquez sur le bouton « add ». La valeur apparaîtra dans la sélection en dessous. Pour supprimer une valeur, sélectionnez-la et cliquez sur « delete ». Avant de cliquer sur la validation (Add ou update), assurez-vous que toutes les valeurs des sélections sont sélectionnées. Si ce n&#39;est pas le cas, la suppression d&#39;un élément ou l&#39;ajout les sélectionnera toutes.
Sinon pour les champs contact, équipement, service, vous pouvez saisir vous-même le nom de l&#39;objet sans utiliser l&#39;auto-complete et ainsi pouvoir utiliser le joker « \* ». Par exemple, il existe plusieurs contacts SrvLin : comme suit SrvLin1, SrvLin2, SrvLin3, vous pourrez utiliser SrvLin\* pour tous les sélectionner.
**All/None**  : Ce lien permet d&#39;ajouter la valeur « \* » dans le cas où la sélection est vide. Sinon, si la sélection contient une ou plusieurs valeurs, le lien permet alors de vider la sélection. 

##### Règles de notification : Supression

![Erreur1](/img/docs/5-3/2020-08-25-del_rule.PNG)

1. Dans un premier temps, il vous suffit de cocher les différentes règles que vous souhaitez supprimer
2. Ensuite, sélectionner l&#39;option « Supprimer »

Si tout s&#39;est bien passé, un message s&#39;affichera pour vous confirmer la suppression du ou des éléments.

##### Désactivation d&#39;un contact : Ajout / Modification

Ajout :

![Erreur1](/img/docs/5-3/2020-08-25-param.PNG)

Vous pouvez cliquer sur le bouton « outils » du menu supérieur puis le sous menu « Contacts désactivés ». Vous arriverez sur la page ci-dessus. Si vous voulez ajouter une règle, cliquez sur le bouton ajouter (la page ci-dessous s&#39;affichera).

![Erreur1](/img/docs/5-3/2020-08-25-param_contact.PNG)

Dans ce formulaire, l&#39;unique champ obligatoire est le Nom du contact (1). Le Second champ (2) permet de définir le niveau de débogage. Une fois les champs modifiés, cliquez sur le bouton « Ajouter ».

Modification :

Si vous voulez modifier un contact à désactiver, cliquez sur son nom (Comme sur l&#39;image ci-dessous).

![Erreur1](/img/docs/5-3/2020-08-25-modif_contact.PNG)


Dans ce formulaire, l&#39;unique champ obligatoire est le Nom du contact (1). Le Second champ (2) permet de définir le niveau de débogage. Une fois les champs modifiés, cliquez sur le bouton Modifier.

##### Désactivation d&#39;un contact : Supression

![Erreur1](/img/docs/5-3/2020-08-25-del_contact.PNG)

1. Dans un premier temps, il vous suffit de cocher les différentes périodes de notification que vous souhaitez supprimer
2. Ensuite, cliquez sur le bouton « Supprimer »

##

- **Si tout s&#39;est bien passé, un message s&#39;affichera pour vous confirmer la suppression du ou des éléments.**
- Appliquer la configuration

Pour appliquer la configuration, il vous suffit de cliquer sur le bouton « outils » du menu supérieur puis sur le bouton « appliquer la configuration » du sous menu. Une fois ceci fait, vous tomberez sur l&#39;aperçu ci-dessous. Les deux zones de texte correspondent aux fichiers de configuration des notifications.

![Erreur1](/img/docs/5-3/2020-08-25-apply_notif.PNG)

## Utilisation

### Génération d'un rapport

### Création d'un acquittement

## Migrations

### 5.2 vers 5.3

#### 5.2 installater avec ansible

Mise à jour du repo EyesOfNetwork
``` bash
sed -i 's+repos/5+repos/5.3+g' /etc/yum.repos.d/EyesOfNetwork.repo
```

Mise à jour de EyesOfNetwork
``` bash
yum update
```

#### 5.2 installater avec l'iso

##### Ajouts et modifications des repo nécessaires

Ajout du repo grafana
``` bash
cat <<EOF | sudo tee /etc/yum.repos.d/grafana.repo
[grafana]
name=grafana
baseurl=https://packages.grafana.com/oss/rpm
repo_gpgcheck=1
enabled=1
gpgcheck=1
gpgkey=https://packages.grafana.com/gpg.key
sslverify=1
sslcacert=/etc/pki/tls/certs/ca-bundle.crt 
EOF
```

Ajout du repo influxdb
``` bash
cat <<EOF | sudo tee /etc/yum.repos.d/influxdb.repo
[influxdb]
name = InfluxDB Repository - RHEL \$releasever
baseurl = https://repos.influxdata.com/rhel/\$releasever/\$basearch/stable
enabled = 1
gpgcheck = 1
gpgkey = https://repos.influxdata.com/influxdb.key
EOF
```

Mise à jour du repo EyesOfNetwork
``` bash
sed -i 's+repos/5+repos/5.3+g' /etc/yum.repos.d/EyesOfNetwork.repo
```

Mise à jour de EyesOfNetwork
``` bash
yum update
```

##### Configuration grafana

Execution du script qui met en place les configuration nécessaire pour grafana
``` bash
/srv/eyesofnetworkconf/grafana/grafanaconf.sh &>/dev/null
```

``` bash
systemctl restart httpd
```

Execution de grafana au démarrage et active grafana  
``` bash
systemctl enable --now grafana-server
```

Configuration de la base de données
``` bash
mysql -u root -proot66 lilac < /srv/eyesofnetworkconf/grafana/grafana.sql
```
Appliquer la configuration


On migre ensuite les anciennes données afin de pouvoir les afficher sur grafana
``` bash
/srv/eyesofnetwork/nagflux/migrate_pnp_to_nagflux.pl
```
### 4.x vers 5.3

#### Migration des bases de données

> La migration concerne plusieurs bases de données. Les bases de données essentielles sont lilac et eonweb. Il est inutile de migrer les bases de données cacti, ged ou nagiosbp si ces outils n'étaient pas utilisés.

##### Export des bases de données

Export de la base lilac

``` bash
mysqldump -u root --password=root66 lilac > lilac.sql   
```

Export de la base eonweb

``` bash
mysqldump -u root --password=root66 eonweb > eonweb.sql    
```

Export d'une base de données

``` bash
mysqldump -u root --password=root66 XXX > XXX.sql                  
```

##### Copie des bases d'un serveur EON à l'autre

``` bash
scp lilac.sql root@servEON5.3:/root/
scp eonweb.sql root@servEON5.3:/root/
scp XXXX.sql root@servEON5.3:/root/
```

Avant de procéder à l'importation de l'ancienne base sur le nouveau EON. Il est préférable de faire un export de la base de données actuelle.

``` bash
mysqldump -u root --password=root66 lilac > /root/lilac-fresh.sql
mysqldump -u root --password=root66 eonweb > /root/eonweb-fresh.sql
mysqldump -u root --password=root66 XXXX > /root/XXXX-fresh.sql
```

##### Import des bases de données

**Importer** les bases de données exportées vers le nouveau serveur EON. Il est conseillé de commencé par l'import de la base de données lilac.

``` bash
mysql -u root -proot66 < lilac.sql
mysql -u root -proot66 eonweb < eonweb.sql
mysql -u root -proot66 XXX < XXX.sql
```

#### Migration des Plugins EON

Création d'une archive contenant l'ensemble des plugins

``` bash
tar -cvzf /root/plugin.tar.gz /srv/eyesofnetwork/nagios/plugins/
```

Copie du fichier sur l'autre EON

``` bash
scp plugin.tar.gz root@servEON5.3:/root/
```

Extraire l'archive

``` bash
tar xvf plugin.tar.gz
```

Copie des fichiers dans le répertoire /nagios/plugins

``` bash
cp -p -v -u * /srv/eyesofnetwork/nagios/plugins/ 
```

> Copie uniquement les fichiers qui sont plus récents que les fichiers de destination ou les fichiers manquants.

#### Vérification après l'importation

Vérifier que l'application de la configuration fonctionne correctement.

> Administration > Appliquer la configuration > Restart

Des erreurs peuvent survenir lors de l'actualisation de l'EON 5.3

Exemple ci-dessous :

![Erreur1](/img/docs/5-3/2020-06-19-erreur1.png)

Cela est à cause d'un changement de version trop important 
Il est possible d'obtenir la version de lilac sur le serveur EON avec la commande :

``` bash
Rpm -qi lilac
```

Pour résoudre le problème, il faut modifier les **permissions** du fichier lilac-conf.php

``` bash
ls -la /srv/eyesofnetwork/lilac/includes/lilac-conf.php
chmod 777 /srv/eyesofnetwork/lilac/includes/lilac-conf.php
chown apache /srv/eyesofnetwork/lilac/includes/lilac-conf.php
```

Une autre fenêtre d'erreur doit apparaitre, celle-ci indique que la version de la base de données n'est pas à jour.

![Erreur2](/img/docs/5-3/2020-06-19-erreur2.png)

Cliquer sur **Update** installation

![Erreur3](/img/docs/5-3/2020-06-19-erreur3.png)

Cliquer sur **Launch lilac-reloaded update site**

**Répéter** cette opération tant que la version n'est pas à jour.

![Erreur4](/img/docs/5-3/2020-06-19-erreur4.png)

Une fois que cette fenêtre apparait, les versions sont à jour.

Cliquer sur click **here**

#### Vérifications

Aller dans :

> Administration > Configuration Nagios > Equipements > Lister

L'ensemble des équipements de l'ancien EON doivent être présents sur le nouveau.

Aller dans :

> Administration > Configuration Nagios > Nagios Commands

L'ensemble des commandes de l'ancien EON doivent être présentes sur le nouveau.

Pour appliquer la configuration, aller dans :

> Administration > Appliquer la configuration > Restart

###### Copie des sauvegardes de l'ancien EON sur le nouveau

Attention, Il faut vérifier la **volumétrie** des sauvegardes avant l'exécution du transfert car cela peut surcharger le nouveau EON.

Copier les fichiers présents dans /var/archives

``` bash
scp /var/archives/servEON4.1.XXXX.tar.gz root@servEON5.3:/var/archives
```

#### Installation du VMware perl SDK

Télécharger le fichier .rpm et copier le sur le serveur EON

``` bash
mv VMware-vSphere-Perl-SDK-6.5.0.rpm /srv/eyesofnetworkrepo/extras/
cd /srv/eyesofnetworkrepo/extras/
createrepo --update /srv/eyesofnetowrkrepo/extras/
yum clean all
yum repolist
```

Le champ "eon-extras" doit apparaitre avec une valeur à 1, ce qui correspond à notre nouveau paquet. En cas d'erreur à cette étape, voir la procédure ci-dessous

``` bash
yum install VMware-vSphere-Perl-SDK
```

###### Si le paquet n'est pas répertorié par la commande yum repolist

``` bash
vim /etc/yum.repos.d/EyesOfNetwork.repo
sed -i "enabled=0/enabled=1/g" /etc/yum.repos.d/EyesOfNetwork.repo
yum clean all
yum repolist
```

###### Vérifier le fonctionnement du plugin :

``` bash
su - nagios
cd /srv/eyesofnetwork/nagios/plugin
./check_vmware_esx.pl -D 10.140.XX.XX --name=XXXXX -u XXXXX -p XXXXXXX --select=cpu --subselect=usage
```